<!DOCTYPE html>
<html>
  <head>
    <title>Facebook Friends</title>
    
    <style type="text/css" media="screen">
      #fb_content { width:100%; height:100%; }
    </style>
  </head>
  
  <body>
    <pre id='fb_content'></pre>

    <script type="text/javascript" charset="utf-8" src="http://yui.yahooapis.com/3.1.2/build/yui/yui-min.js"></script>
    <script type="text/javascript" charset="utf-8">
      
      var app = {
        YUI:null,
        name:'facebook_friends',
        version:0.1,
        openPolls:{},
        user:null
      }
      
      app.initialize = function(Y){
        app.YUI = Y;
        app.getuser();
      }
      
      app.getuser = function(){
        app.YUI.io('/user',
          {on:{
            success:function(transactionId, response, arguments){
              try{
                var _json = app.YUI.JSON.parse(response.responseText);
                if(_json.redirect){
                  window.location = _json.redirect;
                } else if(_json.user){
                  app.user = _json.user;
                  app.getgraphdata('/me/friends');
                }
              }catch(error){
                console.log(error);
              }
            }
          }}
        );
      }
      
      app.getgraphdata = function(uri){
        if(!uri){
          return;
        }
        app.YUI.io('/user/graph'+uri,
          {on:{
            success:function(transactionId, response, arguments){
              try{
                var _json = app.YUI.JSON.parse(response.responseText);
                app.YUI.one('#fb_content').append(app.YUI.JSON.stringify(_json,null,'&nbsp'));
              }catch(error){
                console.log(error);
              }
            }
          }}
        );
      }
      
      YUI().use('io','json','node',function(Y){
        app.initialize(Y);
      });

    </script>
  </body>
</html>
